CREATE TABLE COFFIE_PRODUCT(
    PCODE VARCHAR2(10) NOT NULL,
    NAME VARCHAR2(20),
    COST VARCHAR2(10),
    CONSTRAINT PK_COFFIE_PRODUCT PRIMARY KEY (PCODE)
);

CREATE TABLE COFFIE_SHOP(
    SCODE VARCHAR2(10) NOT NULL,
    SNAME VARCHAR2(20),
    CONSTRAINT PK_COFFIE_SHOP PRIMARY KEY (SCODE)
);

CREATE TABLE COFFIE_SALELIST(
    SALENO NUMBER(10) NOT NULL,
    PCODE VARCHAR2(10) NOT NULL,
    SALEDATE DATE,
    SCODE VARCHAR2(10) NOT NULL,
    AMOUNT NUMBER(10),
    CONSTRAINT PK_COFFIE_SALELIST PRIMARY KEY (SALENO)
);

INSERT INTO COFFIE_PRODUCT VALUES('AA01', '아메리카노', 3000);
INSERT INTO COFFIE_PRODUCT VALUES('AA02', '에스프레소', 3500);
INSERT INTO COFFIE_PRODUCT VALUES('AA03', '카페라떼', 4000);
INSERT INTO COFFIE_PRODUCT VALUES('AA04', '카라멜마끼', 4500);
INSERT INTO COFFIE_PRODUCT VALUES('AA05', '카푸치노', 5000);
INSERT INTO COFFIE_PRODUCT VALUES('AA06', '초코롤케익', 6000);
INSERT INTO COFFIE_PRODUCT VALUES('AA07', '녹차롤케익', 6500);
INSERT INTO COFFIE_PRODUCT VALUES('AA08', '망고쥬스', 7000);
INSERT INTO COFFIE_PRODUCT VALUES('AA09', '핫초코', 2500);

INSERT INTO COFFIE_SHOP VALUES('S001', '강남점');
INSERT INTO COFFIE_SHOP VALUES('S002', '강서점');
INSERT INTO COFFIE_SHOP VALUES('S003', '강동점');
INSERT INTO COFFIE_SHOP VALUES('S004', '강북점');
INSERT INTO COFFIE_SHOP VALUES('S005', '동대문점');
INSERT INTO COFFIE_SHOP VALUES('S006', '인천점');

INSERT INTO COFFIE_SALELIST VALUES('100001', 'AA01', '20180902', 'S001', 50);
INSERT INTO COFFIE_SALELIST VALUES('100002', 'AA03', '20180902', 'S002', 40);
INSERT INTO COFFIE_SALELIST VALUES('100003', 'AA04', '20180902', 'S002', 20);
INSERT INTO COFFIE_SALELIST VALUES('100004', 'AA04', '20180902', 'S001', 30);
INSERT INTO COFFIE_SALELIST VALUES('100005', 'AA05', '20180902', 'S004', 40);
INSERT INTO COFFIE_SALELIST VALUES('100006', 'AA03', '20180902', 'S004', 30);
INSERT INTO COFFIE_SALELIST VALUES('100007', 'AA01', '20180902', 'S003', 40);
INSERT INTO COFFIE_SALELIST VALUES('100008', 'AA04', '20180902', 'S004', 10);
INSERT INTO COFFIE_SALELIST VALUES('100009', 'AA01', '20180902', 'S003', 20);
INSERT INTO COFFIE_SALELIST VALUES('100010', 'AA05', '20180902', 'S003', 30);
INSERT INTO COFFIE_SALELIST VALUES('100011', 'AA01', '20180902', 'S001', 40);
INSERT INTO COFFIE_SALELIST VALUES('100012', 'AA03', '20180902', 'S002', 50);
INSERT INTO COFFIE_SALELIST VALUES('100013', 'AA04', '20180902', 'S002', 50);
INSERT INTO COFFIE_SALELIST VALUES('100014', 'AA05', '20180902', 'S004', 20);
INSERT INTO COFFIE_SALELIST VALUES('100015', 'AA01', '20180902', 'S003', 30);

SELECT 
    PRODUCT.PCODE,
    PRODUCT.NAME,
    SUM(PRODUCT.COST * SALELIST.AMOUNT)
FROM 
    COFFIE_PRODUCT PRODUCT, COFFIE_SALELIST SALELIST
WHERE
    PRODUCT.PCODE = SALELIST.PCODE
GROUP BY 
    PRODUCT.PCODE, PRODUCT.NAME;

SELECT 
    SHOP.SCODE,
    SHOP.SNAME,
    SUM(PRODUCT.COST * SALELIST.AMOUNT)
FROM 
    COFFIE_PRODUCT PRODUCT, COFFIE_SHOP SHOP, COFFIE_SALELIST SALELIST
WHERE
    SHOP.SCODE = SALELIST.SCODE AND
    PRODUCT.PCODE = SALELIST.PCODE
GROUP BY 
    SHOP.SCODE, SHOP.SNAME
ORDER BY
    SHOP.SCODE;

SELECT 
    SALELIST.SALENO,
    SALELIST.PCODE, 
    SALELIST.SALEDATE, 
    PRODUCT.NAME, 
    SALELIST.SCODE, 
    SALELIST.AMOUNT 
FROM 
    COFFIE_SALELIST SALELIST, COFFIE_PRODUCT PRODUCT
WHERE
    PRODUCT.PCODE = SALELIST.PCODE
ORDER BY 
    SALENO;

